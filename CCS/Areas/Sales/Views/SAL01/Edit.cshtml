@model CCS.Models.SAL.cs_comtModel
@using CCS.Common;
@using CCS.Core;
@using CCS.Models.SYS;

@{
    ViewBag.Title = "修改-訂單主檔";
    Layout = "~/Views/Shared/_Index_LayoutEdit.cshtml";
    List<permModel> perm = (List<permModel>)ViewBag.Perm;
    if (perm == null)
    {
        perm = new List<permModel>();
    }
}

<div class="mvctool bgb">
    @Html.ToolButton("btnSave", "icon-save", @Suggestion.Save, perm, "Save", true)
    @Html.ToolButton("btnReturn", "icon-return", Suggestion.Return, false)
</div>
<div style="height:35px"></div>
@using (Html.BeginForm("Edit", "SAL01", new { Area = "Sales" }, FormMethod.Post, new { Id = "EditForm" }))
{
    @Html.ValidationSummary(true)
    <table class="fromEditTable setTextWidth300">
        <tbody>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.VCH_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.VCH_NO, new { htmlAttributes = new { @class = "form-control",@readonly = "readonly" } })
                    @*@Html.HiddenFor(model => model.VCH_NO, new { htmlAttributes = new { @class = "form-control" } })*@
                    @Html.HiddenFor(model => model.ADD_DT, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.HiddenFor(model => model.CFM_DT, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.HiddenFor(model => model.C_CFM, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.HiddenFor(model => model.CFM_USR_NO, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.HiddenFor(model => model.IP_NM, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.HiddenFor(model => model.CP_NM, new { htmlAttributes = new { @class = "form-control" } })
                   
                </td>
                <td>@Html.ValidationMessageFor(model => model.VCH_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.VCH_DT)：
                </td>
                <td style="width:310px">
                    <input id="VCH_DT" name="VCH_DT" class="easyui-datebox" data-options="formatter:myformatter,parser:myparser" value="@Model.VCH_DT.ToString("yyyy-MM-dd")" style = "width: 100%;" />

                </td>
                <td>@Html.ValidationMessageFor(model => model.VCH_DT)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.FA_NO)：
                </td>
                <td style="width:310px">
                    <select id="FA_NO" name="FA_NO" class="easyui-combobox" style="width:100%;">
                        <option value="關廟廠">關廟廠</option>
                    </select>
                    @*@Html.EditorFor(model => model.FA_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.FA_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.DEPM_NO)：
                </td>
                <td style="width:310px">
                    <select id="DEPM_NO" name="DEPM_NO" class="easyui-combobox" style="width:100%;">
                        <option value="業務課">業務課</option>
                    </select>
                    @*@Html.EditorFor(model => model.DEPM_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.DEPM_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.EMP_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.EMP_NO, new { htmlAttributes = new { @class = "easyui-combogrid", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.EMP_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.EMP_NAME)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.EMP_NAME, new { htmlAttributes = new { @class = "", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.EMP_NAME)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CS_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CS_NO, new { htmlAttributes = new { @class = "easyui-combogrid", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CS_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CS_NM)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CS_NM, new { htmlAttributes = new { @class = "", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CS_NM)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CONTACTER)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CONTACTER, new { htmlAttributes = new { @class = "", style = "", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CONTACTER)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TO_ADDR)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.TO_ADDR, new { htmlAttributes = new { @class = "", style = "", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.TO_ADDR)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TEL_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.TEL_NO, new { htmlAttributes = new { @class = "", style = "", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.TEL_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.FAX_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.FAX_NO, new { htmlAttributes = new { @class = "", style = "", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.FAX_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CS_VCH_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CS_VCH_NO, new { htmlAttributes = new { @class = "", style = "", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CS_VCH_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TAX_TY)：
                </td>
                <td style="width:310px">
                    <select id="TAX_TY" name="TAX_TY" class="easyui-combobox" style="width:100%;">
                        <option value="應稅外加" selected="@(Model.TAX_TY == "應稅外加" ? "selected" : "")">應稅外加</option>
                        <option value="應稅內含" selected="@(Model.TAX_TY == "應稅內含" ? "selected" : "")">應稅內含</option>
                    </select>
                    @*@Html.EditorFor(model => model.TAX_TY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.TAX_TY)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TAX_RT)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.TAX_RT, new { htmlAttributes = new { @class = "", style = "", name = "TAX_RT", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.TAX_RT)</td>
            </tr>



            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CURRENCY)：
                </td>
                <td style="width:310px">
                    <select id="CURRENCY" name="CURRENCY" class="easyui-combobox" style="width:100%;">
                        <option value="NTD" selected="@(Model.CURRENCY == "NTD" ? "selected" : "")">NTD</option>
                        <option value="RMB" selected="@(Model.CURRENCY == "RMB" ? "selected" : "")">RMB</option>
                        <option value="USD" selected="@(Model.CURRENCY == "USD" ? "selected" : "")">USD</option>
                    </select>
                    @*@Html.EditorFor(model => model.CURRENCY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.CURRENCY)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.EXCH_RATE)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.EXCH_RATE, new { htmlAttributes = new { @class = "", style = "", name = "EXCH_RATE", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.EXCH_RATE)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.WAHO_NO)：
                </td>
                <td style="width:310px">
                    <select id="WAHO_NO" name="WAHO_NO" class="easyui-combobox" style="width:100%;">
                        <option value="出貨倉">出貨倉</option>
                    </select>
                    @*@Html.EditorFor(model => model.WAHO_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.WAHO_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.SHIP_TY)：
                </td>
                <td style="width:310px">
                    <select id="SHIP_TY" name="SHIP_TY" class="easyui-combobox" style="width:100%;">
                        <option value="陸運"  selected="@(Model.SHIP_TY == "陸運" ? "selected" : "")">陸運</option>
                        <option value="海運"  selected="@(Model.SHIP_TY == "海運" ? "selected" : "")">海運</option>
                        <option value="空運"  selected="@(Model.SHIP_TY == "空運" ? "selected" : "")">空運</option>
                    </select>
                    @*@Html.EditorFor(model => model.SHIP_TY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.SHIP_TY)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.SHIP_CORP)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.SHIP_CORP, new { htmlAttributes = new { @class = "", style = "", name = "CS_NO", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.SHIP_CORP)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.REMK)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.REMK, new { htmlAttributes = new { @class = "easyui-textbox", style = "", name = "CS_NO", multiline = "true", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.REMK)</td>
            </tr>

        </tbody>
    </table>
}


@section scripts{

<script src="~/Content/easyui-1.5/locale/easyui-lang-zh_TW.js"></script>
    <script type="text/javascript">
        $(function () {
      
        $("#btnSave").click(function () {
                $.ajax({
                    url: "/Sales/SAL01/Edit",
                    type: "Post",
                    data: $("#EditForm").serialize(),
                    dataType: "json",
                    success: function (data) {
                        if (data.type == 1) {
                            window.parent.frameReturnByMes("成功");
                            window.parent.frameReturnByReload(true);
                            window.parent.frameReturnByClose()
                        }
                        else {
                            window.parent.frameReturnByMes("失敗");
                        }
                    }
                });
        });

        $("#btnReturn").click(function () {
            window.parent.frameReturnByClose();
        });
    });

        $(document).ready(function () {
            

            // 下拉選單，客戶
            $('#CS_NO').combogrid({
                panelWidth: 600,
                idField: 'CS_NO',
                textField: 'CS_NO',
                url: 'GetCustList',
                method: 'get',
                columns: [[
                { field: 'CS_NO', title: '客戶編號', width: 50 },
                { field: 'SHORT_NM', title: '客戶簡稱', width: 60 },
                { field: 'FULL_NM', title: '客戶全名', width: 80 },
                { field: 'CONTACTER', title: '聯絡人', width: 50, align: 'left' },
                { field: 'TEL_NO', title: '電話', width: 80, align: 'left' },
                { field: 'FAX_NO', title: '傳真', width: 80 },
                { field: 'ADDR_IVC', title: '地址', width: 150, align: 'left' }
                ]],
                fitColumns: true,
                onSelect: function (rec) {
                    //getGridValue();
                    var grid = $("#CS_NO").combogrid("grid");//取得表格物件
                    var row = grid.datagrid('getSelected');//取得資料列
                    $("#CONTACTER").val(row.CONTACTER);
                    $("#TO_ADDR").val(row.ADDR_IVC);
                    $("#CS_NM").val(row.FULL_NM);
                    $("#TEL_NO").val(row.TEL_NO);
                    $("#FAX_NO").val(row.FAX_NO);
                }
            });


            // 下拉選單，員工
            $('#EMP_NO').combogrid({
                panelWidth: 600,
                idField: 'EMP_NO',
                textField: 'EMP_NO',
                url: 'GetEmpList',
                method: 'get',
                columns: [[
                { field: 'EMP_NO', title: '員工編號', width: 50 },
                { field: 'EMP_NM', title: '姓名', width: 60 },
                { field: 'DEPM_NO', title: '部門編號', width: 80 }
                ]],
                fitColumns: true,
                onSelect: function (rec) {
                    //getGridValue();
                    var grid = $("#EMP_NO").combogrid("grid");//取得表格物件
                    var row = grid.datagrid('getSelected');//取得資料列
                    $("#EMP_NAME").val(row.EMP_NM);
                }

            });
    
        
        });

      

    </script>

}