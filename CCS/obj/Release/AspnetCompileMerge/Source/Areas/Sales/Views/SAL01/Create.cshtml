@model CCS.Models.SAL.cs_comtModel
@using CCS.Common;
@using CCS.Core;
@using CCS.Models.SYS;

@{
    ViewBag.Title = "創建";
    Layout = "~/Views/Shared/_Index_LayoutEdit.cshtml";
    List<permModel> perm = (List<permModel>)ViewBag.Perm;
    if (perm == null)
    {
        perm = new List<permModel>();
    }
}

<div class="mvctool bgb">
    @Html.ToolButton("btnSave", "icon-save", @Suggestion.Save, perm, "Save", true)
    @Html.ToolButton("btnReturn", "icon-return", @Suggestion.Return, false)
</div>
@using (Html.BeginForm())
{
    <table class="fromEditTable setTextWidth300">
        <tbody>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.VCH_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.VCH_NO, new { htmlAttributes = new { @class = "form-control", placeholder = "自動產生", disabled = "disabled"} })
                </td>
                <td>@Html.ValidationMessageFor(model => model.VCH_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.VCH_DT)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.VCH_DT, new { htmlAttributes = new { @class = "easyui-datebox", data_options = "formatter:myformatter,parser:myparser",style = "width: 100%;" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.VCH_DT)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.FA_NO)：
                </td>
                <td style="width:310px">
                    <select id="FA_NO" name="FA_NO" class="easyui-combobox" style="width:100%;">
                        <option value="關廟廠">關廟廠</option>
                    </select>
                    @*@Html.EditorFor(model => model.FA_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.FA_NO)</td>
            </tr>
           
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.DEPM_NO)：
                </td>
                <td style="width:310px">
                    <select id="DEPM_NO" name="DEPM_NO" class="easyui-combobox" style="width:100%;">
                        <option value="業務課">業務課</option>
                    </select>
                    @*@Html.EditorFor(model => model.DEPM_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.DEPM_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.EMP_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.EMP_NO, new { htmlAttributes = new { @class = "easyui-combogrid", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.EMP_NO)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CS_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CS_NO, new { htmlAttributes = new { @class = "easyui-combogrid", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CS_NO)</td>
            </tr>
           
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CONTACTER)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CONTACTER, new { htmlAttributes = new { @class = "", style = "width: 100%;",data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CONTACTER)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TO_ADDR)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.TO_ADDR, new { htmlAttributes = new { @class = "", style = "width: 100%;", name = "TO_ADDR", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.TO_ADDR)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CS_VCH_NO)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.CS_VCH_NO, new { htmlAttributes = new { @class = "", style = "width: 100%;", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.CS_VCH_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TAX_TY)：
                </td>
                <td style="width:310px">
                    <select id="CURRENCY" name="CURRENCY" class="easyui-combobox" style="width:100%;">
                        <option value="應稅外加">應稅外加</option>
                        <option value="應稅內含">應稅內含</option>
                    </select>
                    @*@Html.EditorFor(model => model.TAX_TY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.TAX_TY)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.TAX_RT)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.TAX_RT, new { htmlAttributes = new { @class = "", style = "width: 100%;", name = "TAX_RT", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.TAX_RT)</td>
            </tr>
      
            
          
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.CURRENCY)：
                </td>
                <td style="width:310px">
                    <select id="CURRENCY" name="CURRENCY" class="easyui-combobox"  style="width:100%;">
                        <option value="NTD">NTD</option>
                        <option value="RMB">RMB</option>
                        <option value="USD">USD</option>
                    </select>
                    @*@Html.EditorFor(model => model.CURRENCY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.CURRENCY)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.EXCH_RATE)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.EXCH_RATE, new { htmlAttributes = new { @class = "", style = "width: 100%;", name = "EXCH_RATE", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.EXCH_RATE)</td>
            </tr>
            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.WAHO_NO)：
                </td>
                <td style="width:310px">
                    <select id="WAHO_NO" name="WAHO_NO" class="easyui-combobox"  style="width:100%;">
                        <option value="出貨倉">出貨倉</option>
                    </select>
                    @*@Html.EditorFor(model => model.WAHO_NO)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.WAHO_NO)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.SHIP_TY)：
                </td>
                <td style="width:310px">
                    <select id="SHIP_TY" name="SHIP_TY" class="easyui-combobox"  style="width:100%;">
                        <option value="陸運">陸運</option>
                        <option value="海運">海運</option>
                        <option value="空運">空運</option>
                    </select>
                    @*@Html.EditorFor(model => model.SHIP_TY)*@
                </td>
                <td>@Html.ValidationMessageFor(model => model.SHIP_TY)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.SHIP_CORP)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.SHIP_CORP, new { htmlAttributes = new { @class = "", style = "width: 95%;", name = "CS_NO", data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.SHIP_CORP)</td>
            </tr>

            <tr>
                <td style="width:100px; text-align:right;">
                    @Html.LabelFor(model => model.REMK)：
                </td>
                <td style="width:310px">
                    @Html.EditorFor(model => model.REMK, new { htmlAttributes = new { @class = "easyui-textbox", style = "width: 100%;", name = "CS_NO", multiline = "true",data_options = "" } })
                </td>
                <td>@Html.ValidationMessageFor(model => model.REMK)</td>
            </tr>
  
        </tbody>
    </table>
}


@section scripts{
    
 <script type="text/javascript">
     $(document).ready(function () {
         // 下拉選單，客戶
         $('#CS_NO').combogrid({
             panelWidth: 600,
             idField: 'CS_NO',
             textField: 'SHORT_NM',
             url: 'GetCustList',
             method: 'get',
             columns: [[
             { field: 'CS_NO', title: '客戶編號', width: 50 },
             { field: 'SHORT_NM', title: '客戶簡稱', width: 60 },
             { field: 'FULL_NM', title: '客戶全名', width: 80 },
             { field: 'CONTACTER', title: '聯絡人', width: 50, align: 'left' },
             { field: 'TEL_NO', title: '電話', width: 80, align: 'left' },
             { field: 'FAX_NO', title: '傳真', width: 80 },
             { field: 'ADDR_IVC', title: '地址', width: 150, align: 'left' }
             ]],
             fitColumns: true,
             onSelect: function (rec) {
                 //getGridValue();
                 var grid = $("#CS_NO").combogrid("grid");//获取表格对象
                 var row = grid.datagrid('getSelected');//获取行数据
                 $("#CONTACTER").val(row.CONTACTER);
                 $("#TO_ADDR").val(row.ADDR_IVC);
                
             }

         });

         function getGridValue() {
             var grid = $("#CS_NO").combogrid("grid");//获取表格对象
             var row = grid.datagrid('getSelected');//获取行数据
             $("#CONTACTER").val(row.CONTACTER);
             alert("选择的grid中的数据如下：客戶代號:" + row.CS_NO + " 簡稱:" + row.SHORT_NM + " 連絡人:" + row.CONTACTER );
         }
         // 下拉選單，員工
         $('#EMP_NO').combogrid({
             panelWidth: 600,
             idField: 'EMP_NO',
             textField: 'EMP_NM',
             url: 'GetEmpList',
             method: 'get',
             columns: [[
             { field: 'EMP_NO', title: '員工編號', width: 50 },
             { field: 'EMP_NM', title: '姓名', width: 60 },
             { field: 'DEPM_NO', title: '部門編號', width: 80 }
             ]],
             fitColumns: true

         });
     });

    

     $(function () {
         $("#btnSave").click(function () {
             if ($("form").valid()) {
                 $.ajax({
                     url: "@Url.Action("Create")",
                     type: "Post",
                     data: $("form").serialize(),
                     dataType: "json",
                     success: function (data) {
                         if (data.type == 1) {
                             window.parent.frameReturnByMes(data.message);
                             window.parent.frameReturnByReload(true);
                             window.parent.frameReturnByClose()
                         }
                         else {
                             window.parent.frameReturnByMes(data.message);
                         }
                     }
                 });
             }
             return false;
         });
         $("#btnReturn").click(function () {
             window.parent.frameReturnByClose();
         });
    


         function myformatter(date){
             var y = date.getFullYear();
             var m = date.getMonth()+1;
             var d = date.getDate();
             return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
         }
         function myparser(s){
             if (!s) return new Date();
             var ss = (s.split('-'));
             var y = parseInt(ss[0],10);
             var m = parseInt(ss[1],10);
             var d = parseInt(ss[2],10);
             if (!isNaN(y) && !isNaN(m) && !isNaN(d)){
                 return new Date(y,m-1,d);
             } else {
                 return new Date();
             }
         }
});
</script>
       
 }