@model CCS.Models.SAL.cs_comtModel
@using CCS.Common;
@using CCS.Models.SAL;

@{
    ViewBag.Title = "創建";
    Layout = "~/Views/Shared/_Index_LayoutEdit.cshtml";
}




<div class="mvctool bgb">
    <a id="btnSave" style="float: left;" class="l-btn l-btn-plain"><span class="l-btn-left"><span class="l-btn-text icon-save" style="padding-left: 20px;">保存</span></span></a>
</div>
@using (Html.BeginForm("Create", "SAL01", new { Area="Sales"}, FormMethod.Post, new { Id = "CreateForm" }))
{
    @Html.ValidationSummary(true)
    <table class="fromEditTable setTextWidth300">
        <tbody>
            <tr>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.VCH_NO)：
                </td>
                <td >
                    @Html.EditorFor(model => model.VCH_NO ,new { htmlAttributes = new { @class = "easyui-textbox", style= "width:150px; " } })
                </td>
                <td >
                    @Html.ValidationMessageFor(model => model.VCH_NO)
                </td>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.VCH_DT)：
                </td>
                <td >
                    @Html.EditorFor(model => model.VCH_DT, new { htmlAttributes = new { @class = "easyui-datebox", style = "width:150px; ", data_options = "formatter:myformatter,parser:myparser" } })
                </td>
                <td >
                    @Html.ValidationMessageFor(model => model.VCH_DT)
                </td>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.CS_NO)：
                </td>

                <td>
                    @*@Html.EditorFor(model => model.CS_NO)*@
                    <select id="CS_NO" name="CS_NO" class="easyui-combogrid" style="width:150px" data-options=""></select>
                </td>
                <td>
                    @Html.ValidationMessageFor(model => model.CS_NO)
                </td>
            </tr>

            <tr>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.FA_NO)：
                </td>

                <td >
                    @Html.EditorFor(model => model.FA_NO, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
                </td>
                <td>
                    @Html.ValidationMessageFor(model => model.FA_NO)
                </td>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.DEPM_NO)：
                </td>

                <td >
                    @Html.EditorFor(model => model.DEPM_NO, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
                </td>
                <td>
                    @Html.ValidationMessageFor(model => model.DEPM_NO)
                </td>
                <td style="text-align:right;">
                    @Html.LabelFor(model => model.EMP_NO)：
                </td>

                <td >
                    @Html.EditorFor(model => model.EMP_NO, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
                </td>
                <td>
                    @Html.ValidationMessageFor(model => model.EMP_NO)
                </td>
            </tr>
          
           <tr>
               <td style="text-align:right;">
                   @Html.LabelFor(model => model.CURRENCY)：
               </td>

               <td >
                   @Html.EditorFor(model => model.CURRENCY, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
               </td>
               <td>
                   @Html.ValidationMessageFor(model => model.CURRENCY)
               </td>
               <td style="text-align:right;">
                   @Html.LabelFor(model => model.C_CFM)：
               </td>

               <td >
                   @Html.EditorFor(model => model.C_CFM, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
               </td>
               <td>
                   @Html.ValidationMessageFor(model => model.C_CFM)
               </td>
               <td style="text-align:right;">
                   @Html.LabelFor(model => model.C_CLS)：
               </td>

               <td >
                   @Html.EditorFor(model => model.C_CLS, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:150px; " } })
               </td>
               <td>
                   @Html.ValidationMessageFor(model => model.C_CLS)
               </td>
           </tr>
            <tr>
                <td colspan="9">
                    <table>
                        <tr>
                            <td style="text-align:center;">@Html.LabelFor(model => model.ITEM_NO)</td>
                            <td style="text-align:center;">@Html.LabelFor(model => model.PL)</td>
                            <td style="text-align:center;">@Html.LabelFor(model => model.UNIT)</td>
                            <td style="text-align:center;">@Html.LabelFor(model => model.QTY)</td>
                            <td style="text-align:center;">@Html.LabelFor(model => model.PRC)</td>
                            <td style="text-align:center;">@Html.LabelFor(model => model.AMT)</td>
                        </tr>
                        <tr>
                            <td>@Html.EditorFor(model => model.ITEM_NO, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:200px; " } })</td>
                            <td>@Html.EditorFor(model => model.PL, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:120px; " } })</td>
                            <td>@Html.EditorFor(model => model.UNIT, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:120px; " } })</td>
                            <td>@Html.EditorFor(model => model.QTY, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:120px; " } })</td>
                            <td>@Html.EditorFor(model => model.PRC, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:120px; " } })</td>
                            <td>@Html.EditorFor(model => model.AMT, new { htmlAttributes = new { @class = "easyui-textbox", style = "width:120px; " } })</td>
                        </tr>
                    </table>

                </td>
            </tr>
           
    
           
        </tbody>
    </table>
    
}


@section scripts{
    
 <script type="text/javascript">
     $(document).ready(function () {
         // 下拉選單，收圖單位
         $('#CS_NO').combogrid({
             panelWidth: 600,
             idField: 'CS_NO',
             textField: 'SHORT_NM',
             url: 'GetCustList',
             method: 'get',
             columns: [[
             { field: 'CS_NO', title: '客戶編號', width: 80 },
             { field: 'SHORT_NM', title: '客戶簡稱', width: 80 },
             { field: 'CONTACTER', title: '聯絡人', width: 80, align: 'left' },
             { field: 'TEL_NO', title: '電話', width: 80, align: 'left' },
             { field: 'FAX_NO', title: '傳真', width: 80 },
             { field: 'ADDR_IVC', title: '地址', width: 150, align: 'left' }
             ]],
             fitColumns: true

         });
     });

    $(function () {

       
        $("#btnSave").click(function () {
                $.ajax({
                    url: "/Sales/SAL01/Create",
                    type: "Post",
                    data: $("#CreateForm").serialize(),
                    dataType: "json",
                    success: function (data) {
                        //if (data == 1) {
                        //    window.parent.frameReturnByMes("成功");
                        //    window.parent.frameReturnByReload(true);
                        //    window.parent.frameReturnByClose()
                        //}
                        //else {
                        //    window.parent.frameReturnByMes("失敗");
                        //}

                        if (data.type == 1) {
                            window.parent.frameReturnByMes(data.message);
                            window.parent.frameReturnByReload(true);
                            window.parent.frameReturnByClose()
                        }
                        else {
                            window.parent.frameReturnByMes(data.message);
                        }
                    }
                });
        });
    });


        function myformatter(date){
            var y = date.getFullYear();
            var m = date.getMonth()+1;
            var d = date.getDate();
            return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
        }
        function myparser(s){
            if (!s) return new Date();
            var ss = (s.split('-'));
            var y = parseInt(ss[0],10);
            var m = parseInt(ss[1],10);
            var d = parseInt(ss[2],10);
            if (!isNaN(y) && !isNaN(m) && !isNaN(d)){
                return new Date(y,m-1,d);
            } else {
                return new Date();
            }
        }

</script>
       
 }